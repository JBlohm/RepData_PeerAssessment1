---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
data <- read.table(unz("activity.zip", "activity.csv"), header=TRUE, sep=",")
data <- data[complete.cases(data), ]
```

## What is mean total number of steps taken per day?

To find out we calculate the total number of steps taken per day and draw a histogram showing the frequency distribution.

```{r}
total_steps_per_day <- aggregate(steps ~ date, data = data, FUN = sum)
hist(total_steps_per_day$steps, main = "Histogram: Total number of steps taken each day", xlab = "Total number of steps per day")
```

Now we calculate and show the mean and median of the total number of steps taken per day:

```{r}
print(paste("Mean of total steps per day:", mean(total_steps_per_day$steps)))
```
```{r}
print(paste("Median of total steps per day:", median(total_steps_per_day$steps)))
```


## What is the average daily activity pattern?

To find out, we calculate the mean number of steps per five minutes interval.

Then we show the corresponding time series plot and mark the interval with the highest average number of steps accross all days.

```{r}
five_minutes_interval_steps_mean <- aggregate(steps ~ interval, data = data, FUN = mean)
# Make the plot
plot(x = five_minutes_interval_steps_mean$interval, y = five_minutes_interval_steps_mean$steps, type = "l", main = "Daily activity pattern", xlab = "Five minutes interval step", ylab = "Mean number of steps")
# Mark the 5 minutes interval whis has the highest average steps per day with a red dotted line
abline(v = five_minutes_interval_steps_mean$interval[which.max(five_minutes_interval_steps_mean$steps)], col="red", lty=2)
```

The 5-minute interval, on average accross all days in the dataset, containing the maximum number of steps is: (Also see: Red dotted line in plot)

```{r}
five_minutes_interval_steps_mean$interval[which.max(five_minutes_interval_steps_mean$steps)]
```


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
